<!DOCTYPE html>
<html lang="de">
<head>
  <meta name="description" content="Blog und Unterrichtsmaterial zu Digitale Systeme und Computersysteme">
  <meta name="author" content="Günther Jena">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="https://www.semiversus.com/favicon.ico">
  <title>Semiversus | VHDL Test (4)</title>
  <link href="https://www.semiversus.com/theme/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://www.semiversus.com/theme/css/font-awesome.min.css" rel="stylesheet">
  <link href="https://www.semiversus.com/theme/css/semiversus.css" rel="stylesheet">
  <link href="https://www.semiversus.com/theme/css/pygments.css" rel="stylesheet">
  <script src="https://www.semiversus.com/theme/js/jquery.min.js"></script>
  <script src="https://www.semiversus.com/theme/js/bootstrap.min.js"></script>

    <script type= "text/javascript">
        var s = document.createElement('script');
        s.type = 'text/javascript';
        s.src = 'https:' == document.location.protocol ? 'https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML' : 'http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'; 
        s[(window.opera ? "innerHTML" : "text")] =
            "MathJax.Hub.Config({" + 
            "    config: ['MMLorHTML.js']," + 
            "    jax: ['input/TeX','input/MathML','output/HTML-CSS','output/NativeMML']," +
            "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," + 
            "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
            "    tex2jax: { " +
            "        inlineMath: [ ['%%','%%'] ], " +
            "        processEscapes: false }, " +
            "    'HTML-CSS': { " +
            "        styles: { '.MathJax .mo, .MathJax .mi': {color: 'black ! important'}} " +
            "    } " +
            "}); ";
        (document.body || document.getElementsByTagName('head')[0]).appendChild(s);
    </script>
</head>
<body data-spy="scroll" data-target="#sidebar" data-offset=30>
  <div id="wrap">
    <nav class="navbar navbar-inverse">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
          </button>
          <a href="https://www.semiversus.com/index.html" class="navbar-brand">SEMIVERSUS</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="https://www.semiversus.com/index.html">Blog</a></li>
            <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Unterricht<b class="carret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="https://www.semiversus.com/dic/uebersicht.html"><em>Übersicht</em></a></li>
                <li><a href="https://www.semiversus.com/dic/grundlagen_der_digitaltechnik/uebersicht.html">Grundlagen der Digitaltechnik</a></li>
                <li><a href="https://www.semiversus.com/dic/programmierbare_logik/uebersicht.html">Programmierbare Logik</a></li>
                <li><a href="https://www.semiversus.com/dic/mikrocontroller/uebersicht.html">Mikrocontroller</a></li>
                <li><a href="https://www.semiversus.com/dic/hardwarenahe_programmierung/uebersicht.html">Hardwarenahe Programmierung</a></li>
                <li><a href="https://www.semiversus.com/dic/halbleiterelemente/uebersicht.html">Halbleiterelemente</a></li>
                <li><a href="https://www.semiversus.com/dic/bussysteme/uebersicht.html">Bussysteme</a></li>
                <li><a href="https://www.semiversus.com/dic/rechnerarchitektur/uebersicht.html">Rechnerarchitektur</a></li>
                <li><a href="https://www.semiversus.com/dic/digitale_signalverarbeitung/uebersicht.html">Digitale Signalverarbeitung</a></li>
                <li><a href="https://www.semiversus.com/dic/komplexe_digitale_systeme/uebersicht.html">Komplexe digitale Systeme</a></li>
              </ul>
            <li><a href="https://www.semiversus.com/projekte/projekte.html">Projekte</a></li>
            <li><a href="https://www.semiversus.com/about.html">Über mich</a></li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li><a href="https://github.com/semiversus" class="social" data-toggle="tooltip" data-placement="bottom" title="Github.com/Semiversus"><span class="fa fa-github fa-2x"></span></a></li>
            <li><a href="http://stackoverflow.com/users/363745/günther-jena" class="social" data-toggle="tooltip" data-placement="bottom" title="Stackoverflow.com/Semiversus"><span class="fa fa-stack-overflow fa-2x"></span></a></li>
            <li><a href="https://www.semiversus.com/semiversus.atom.xml" class="social" data-toggle="tooltip" data-placement="bottom" title="RSS Feed"><span class="fa fa-rss fa-2x"></span></a></li>
          </ul>
        </div>
      </div>
    </nav>
    <div class="container">
    <div class="visible-print-block">Semiversus | VHDL Test (4)</div>
<ol class="breadcrumb hidden-print"><li><a href="https://www.semiversus.com/dic/uebersicht.html">Digitale Systeme und Computersysteme</a></li><li><a href="https://www.semiversus.com/dic/programmierbare_logik/uebersicht.html">Programmierbare Logik</a></li><li><a href="https://www.semiversus.com/dic/programmierbare_logik/test_vhdl/uebersicht.html">Test - VHDL</a></li><li><strong>VHDL Test (4)</strong></li></ol>      <div class="row">
        <div class="col-md-8" role="main">
  <header><h1>VHDL Test (4)<div class="pull-right hidden-print"><a href="https://www.semiversus.com/dic/programmierbare_logik/test_vhdl/test4.md"  class="btn btn-default btn-xs" data-toggle="tooltip" data-placement="bottom" title="Quelltext zu dieser Seite"><span class="fa fa-file-text-o fa-lg"></span></a></div></h1></header>
  <h1 id="allgemeines">Allgemeines</h1>
<ul>
<li><a class="download" href="https://www.semiversus.com/dic/programmierbare_logik/test_vhdl/vhdl_test_4.zip">Projektordner</a> herunterladen und entpacken</li>
<li>Insgesamt gibt es <span class="badge">20 Punkte</span></li>
<li>Die einzelnen Punkte bauen meist nicht aufeinander auf. Statt langer Fehlersuche lieber auf das n&auml;chste Beispiel wechseln.</li>
</ul>
<h1 id="serielle-datenubertragung">Serielle Daten&uuml;bertragung</h1>
<h2 id="vorbereitung">Vorbereitung</h2>
<ul>
<li>Projekt <samp>transmitter.xise</samp> &ouml;ffnen</li>
</ul>
<h2 id="aufgabenstellung">Aufgabenstellung</h2>
<p>Um Daten zu &Uuml;bertragen wird oft die serielle Schnittstelle verwendet. In diesem Beispiel soll ein Transmitter entsprechend
RS232 realisiert werden.</p>
<figure><img src="https://www.semiversus.com/dic/hardwarenahe_programmierung/rs232_timing.png"><figcaption>RS232 Timingdiagramm (Bild: <a href="https://commons.wikimedia.org/wiki/File:RS-232_timing.png">Gerald.deppe</a> Public Domain)</figcaption></img></figure>
<p>Zum Testen soll mittels der acht Umschaltern (<samp>SW0</samp> bis <samp>SW7</samp>) ein 8 Bit Datenwort definiert werden und
durch Dr&uuml;cken des Tasters <samp>BTN0</samp> wird dieses dann <em>versendet</em>. Zum Versenden wird der Pegel der Sendeleitung
mittels LED angezeigt. Die Baudrate wird auf 1 Baud gestellt.</p>
<h2 id="uart_tx-komponente"><samp>uart_tx</samp> Komponente</h2>
<h3 id="zustandsmaschine">Zustandsmaschine</h3>
<p><span class="badge">10 Punkte</span></p>
<ul>
<li>Die erforderliche Zustandsmaschine hat die Zust&auml;nde <code>IDLE</code>, <code>START</code>, <code>DATA</code> und <code>STOP</code></li>
<li>Eing&auml;nge:<ul>
<li><code>send_i</code> - startet die &Uuml;bertragung</li>
<li>&Uuml;berlauf den Baudraten Generators - wechselt bei einer laufenden &Uuml;bertragung zum n&auml;chsten Symbol</li>
</ul>
</li>
<li>Ausg&auml;nge:<ul>
<li><code>tx_o</code> - das zu sendende Bit (bzw. Symbol)</li>
<li><code>busy_o</code> - zeigt eine laufende &Uuml;bertragung an (<code>'1'</code> wenn eine &Uuml;bertragung l&auml;uft)</li>
</ul>
</li>
<li>Wenn die Zustandsmaschine im Zustand <code>IDLE</code> ist und <code>send_i</code> gleich <code>'1'</code> ist, dann wird in den Zustand <code>START</code> gewechselt.</li>
<li>Vom Zustand <code>START</code> wird in den Zustand <code>DATA</code> gewechselt, sobald der Z&auml;hler f&uuml;r die Baudrate &uuml;bergelaufen ist</li>
<li>Im Zustand <code>DATA</code> l&auml;uft ein Bit Z&auml;hler und z&auml;hlt die Bits von 0 bis 7 (LSB zuerst)</li>
<li>Jedes Bit wird f&uuml;r die Dauer ausgegeben, die sich aus der Baudrate ergibt</li>
<li>Nach dem 8. Datenbit wird in den Zustand <code>STOP</code> gewechselt</li>
<li>Vom Zustand <code>STOP</code> wird in den Zustand <code>IDLE</code> gewechselt, sobald der Z&auml;hler f&uuml;r die Baudrate &uuml;bergelaufen ist</li>
<li>Ausgabe von <code>tx_o</code><ul>
<li>Ist in <code>IDLE</code> und <code>STOP</code> auf <code>'1'</code></li>
<li>Ist in <code>START</code> auf <code>'0'</code></li>
<li>Entspricht w&auml;hrend <code>DATA</code> dem zu &uuml;bertragenden Datenbit</li>
</ul>
</li>
</ul>
<h3 id="baudratengenerierung">Baudratengenerierung</h3>
<p><span class="badge">2 Punkte</span></p>
<p>F&uuml;r die Baudratengenerierung wird der bestehende Z&auml;hler (<samp>counter</samp>) verwendet. Die Entity enth&auml;lt die beiden
Generics <samp>BAUDRATE_WIDTH</samp> und <samp>BAUDRATE_DIVIDER</samp>, die den Z&auml;hler konfigurieren.</p>
<h3 id="bit-zahler">Bit Z&auml;hler</h3>
<p><span class="badge">2 Punkte</span></p>
<p>Um die einzelnen Datenbits zu z&auml;hlen (w&auml;hrend des Zustands <code>DATA</code>) wird eine weitere Z&auml;hlerinstanz verwendet. Diese
Z&auml;hlerinstanz z&auml;hlt von 0 bis 7.</p>
<p>Der Ausgang <code>value_o</code> des Bit Z&auml;hlers ist vom Typ <samp>std_ulogic_vector</samp>. Dieser muss zuerst in einen <samp>unsigned</samp>
und dann mittels <samp>to_integer</samp> in einen Integer gewandelt werden, um mittels Indexzugriff das gew&uuml;nschte Bit aus
dem <code>data_i</code> Vektor zu holen (z.B. <code>data_i(0)</code> holt Bit 0 des Vektors).</p>
<h3 id="blockschaltbild">Blockschaltbild</h3>
<p>Dieses Blockschaltbild zeigt die einzelnen Komponenten der <samp>uart_tx</samp> Komponente. Die resultierende VHDL
Beschreibung sollte &auml;quvivalent zu diesem Blockschaltbild sein.</p>
<p><img alt="Blockschaltbild uart_tx" src="https://www.semiversus.com/dic/programmierbare_logik/test_vhdl/test4_uart_tx.jpg"/></p>
<div class="panel panel-info">
<div class="panel-heading">Testbench</div>
<div class="panel-body">
<p>Teste die Implementierung mittels der Testbench <samp>uart_tx_tb.vhd</samp>.</p>
</div>
</div>
<h2 id="implementierung-des-top-levels_1">Implementierung des Top Levels</h2>
<p><span class="badge">3 Punkte</span></p>
<p>Zur Verf&uuml;gung stehen die Komponenten <samp>button_dectect</samp> und <samp>uart_tx</samp>. Diese
Komponenten werden genutzt, um im Top Level <samp>transmitter.vhd</samp> die gew&uuml;nschte Funktionalit&auml;t zu realisieren.</p>
<p>Einige ben&ouml;tigte Signale sind bereits vordefiniert.</p>
<p>Erstelle das Top Level anhand des folgenden Blockschaltbildes:</p>
<p><img alt="Blockschaltbild transmitter" src="https://www.semiversus.com/dic/programmierbare_logik/test_vhdl/test4_transmitter.jpg"/></p>
<div class="panel panel-info">
<div class="panel-heading">Testbench</div>
<div class="panel-body">
<p>Teste die Implementierung mittels der Testbench <samp>transmitter_tb.vhd</samp>.</p>
</div>
</div>
<h2 id="erweiterung-der-constraints-datei">Erweiterung der <em>Constraints</em> Datei</h2>
<p><span class="badge">2 Punkte</span></p>
<p>In der Datei <samp>transmitter.ucf</samp> ist nur das Signal <code>clk</code> definiert. Erweitere die Datei um folgende Zuordnungen</p>
<ul>
<li><code>button_send_i</code> liegt an Pin <code>G12</code></li>
<li><code>switches_data_i(0)</code> liegt an Pin <code>P11</code></li>
<li><code>switches_data_i(1)</code> liegt an Pin <code>L3</code></li>
<li><code>switches_data_i(2)</code> liegt an Pin <code>K3</code></li>
<li><code>switches_data_i(3)</code> liegt an Pin <code>B4</code></li>
<li><code>switches_data_i(4)</code> liegt an Pin <code>G3</code></li>
<li><code>switches_data_i(5)</code> liegt an Pin <code>F3</code></li>
<li><code>switches_data_i(6)</code> liegt an Pin <code>E2</code></li>
<li><code>switches_data_i(7)</code> liegt an Pin <code>N3</code></li>
<li><code>led_tx_o</code> liegt an Pin <code>M5</code></li>
<li><code>led_busy_o</code> liegt an Pin <code>M11</code></li>
</ul>
<figure><img src="https://www.semiversus.com/dic/programmierbare_logik/basys2_pinout.svg"><figcaption>Pinout des BASYS2 Boards(Bild: <a href="http://www.digilentinc.com/Products/Detail.cfm?NavPath=2,400,790&amp;Prod=BASYS2">Digilent Inc. BASYS2 Manual</a>)</figcaption></img></figure>
<h2 id="test-am-board">Test am Board</h2>
<p><span class="badge">1 Punkt</span></p>
<p>Synthetisiere das Projekt und teste das Ergebnis am Board</p>
        </div>
        <div class="col-md-4" role="complementary">
    <nav class="well well-sm" data-spy="affix" data-offset-top="0" id="sidebar">
    <ul class="nav"><li><a href="#allgemeines">Allgemeines</a></li><li><a href="#serielle-datenubertragung">Serielle Daten&uuml;bertragung</a><ul class="nav"><li><a href="#vorbereitung">Vorbereitung</a></li><li><a href="#aufgabenstellung">Aufgabenstellung</a></li><li><a href="#uart_tx-komponente">uart_tx Komponente</a><ul class="nav"><li><a href="#zustandsmaschine">Zustandsmaschine</a></li><li><a href="#baudratengenerierung">Baudratengenerierung</a></li><li><a href="#bit-zahler">Bit Z&auml;hler</a></li><li><a href="#blockschaltbild">Blockschaltbild</a></li></ul></li><li><a href="#implementierung-des-top-levels_1">Implementierung des Top Levels</a></li><li><a href="#erweiterung-der-constraints-datei">Erweiterung der Constraints Datei</a></li><li><a href="#test-am-board">Test am Board</a></li></ul></li></ul>
    </nav>
        </div>
      </div>
    </div>
  </div>
  <footer class="footer hidden-print"><div class="container"><p class="text-muted credit"><a href="http://creativecommons.org/licenses/by-sa/3.0/de/">CC-BY-SA</a> | Günther Jena 2011 - 2016 | Letztes Update am 29.3.2016 (Rev. <a href="https://github.com/semiversus/semiversus.github.io-source/commit/9264dd6">9264dd6</a>)</p></div></footer>
</body>
</html>